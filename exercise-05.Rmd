---
title: "Exercise 05"
output: html_document
date: "2024-02-28"
---

### Challenge 1

```{r}
library(tidyverse)
library(dplyr)
library(mosaic)
library(radiant)
library(sciplot)
library(infer)
library(tidylog)
library(data.table)
```

**Step 1**
First, I'm loading in the “IMDB-movies.csv” dataset as a tibble.

```{r}
f <- "https://raw.githubusercontent.com/difiore/ada-2024-datasets/main/IMDB-movies.csv"
(d <- read_csv(f, col_names = TRUE))
```

**Step 2**
Now I am going to filter the dataset to include just movies from 1920 to 1979 and movies that are between 1 and 3 hours long, and add a new column that codes the startYear into a new variable, decade.

```{r}
(d <- filter(d, runtimeMinutes >= 60 & runtimeMinutes <= 180, startYear >= 1920 & startYear <= 1979) |>
  mutate(decade = case_when( #If...
  startYear >= 1970 & startYear <= 1979 ~ "70s",
  startYear >= 1960 & startYear <= 1969 ~ "60s",
  startYear >= 1950 & startYear <= 1959 ~ "50s",
  startYear >= 1940 & startYear <= 1949 ~ "40s",
  startYear >= 1930 & startYear <= 1939 ~ "30s",
  startYear >= 1920 & startYear <= 1929 ~ "20s", 
  TRUE ~ "NA"
)))
```

**Step 3** 
Below, I am plotting histograms of the distribution of runtimeMinutes for each decade.

```{r}
(p <- ggplot(d,aes(x=runtimeMinutes))+ geom_histogram()+ facet_wrap(~decade))
```

**Step 4**
Now I am going to calculate the population mean and population standard deviation in runtimeMinutes for each decade and save the results in a new dataframe.

```{r}
(results <- d |> group_by(decade) |>
  summarise(mean_runtimeMinutes=mean(runtimeMinutes),sdpop_runtimeMinutes=sdpop(runtimeMinutes)))
```

**Step 5**
Here, I am drawing a single sample of 100 movies (without replacement) from each decade and calculating the single sample mean and single sample standard deviation in runtimeMinutes for each decade.
```{r}
s <- slice_sample(d,n=100,by=decade,replace=FALSE) #Drawing a single sample of 100 movies without replacement from each decade

(sampleresults <- s |> group_by(decade) |>
  summarise(sample_mean_runtimeMinutes=mean(runtimeMinutes),sd_runtimeMinutes=sd(runtimeMinutes))) #sample mean & sample standard deviation 

```

**Step 6**
Now, I will calculate for each decade the standard error around the estimate of the population mean runtimeMinutes based on the standard deviation and sample size (n=100 movies) of this single sample.
```{r}
(sampleresults <- s |> group_by(decade) |>
  summarise(sample_mean_runtimeMinutes=mean(runtimeMinutes),sd_runtimeMinutes=sd(runtimeMinutes),se_runtimeMinutes=sd(runtimeMinutes)/sqrt(100))) #Now standard error by decade as well
```

**ICOMPLETE Step 7**
Now, I will compare these estimates to the actual population mean runtimeMinutes for each decade and to the calculated SE in the population mean for samples of size 100 based on the population standard deviation for each decade.
```{r}

```


**INCOMPLETE Step 8**
Here, I'm generate a sampling distribution of mean runtimeMinutes for each decade by [a] drawing 1000 random samples of 100 movies from each decade, without replacement, and, for each sample, [b] calculating the mean runtimeMinutes and the standard deviation in runtimeMinutes for each decade.
```{r}

```


**INCOMPLETE Step 9**
Now, I'm going to calculate the mean and the standard deviation of the sampling distribution of sample means for each decade and plot a histogram of the sampling distribution for each decade.
```{r}

```


**INCOMPLETE Step 10**
Lastly, I am comparing the standard error in runtimeMinutes for samples of size 100 from each decade [1] as estimated from my first sample of 100 movies, [2] as calculated from the known population standard deviations for each decade, and [3] as estimated from the sampling distribution of sample means for each decade.
```{r}

```


### Challenge 2

**Step 1**
Now I'm loading the “zombies.csv” dataset as a “tibble” named z.
```{r}
file <- "https://raw.githubusercontent.com/difiore/ada-2024-datasets/main/zombies.csv"
(z <- read_csv(file, col_names = TRUE))
```

**Step 2**
Now, I'm calculating the population mean and standard deviation for each quantitative random variable in the dataset (height, weight, age, number of zombies killed, and years of education).
```{r}
(zresults <- z |> summarise(pop_mean_height=mean(height),sdpop_height=sdpop(height),pop_mean_weight=mean(weight),sdpop_weight=sdpop(weight),pop_mean_zombies_killed=mean(zombies_killed),sdpop_zombies_killed=sdpop(zombies_killed),pop_mean_years_of_education=mean(years_of_education),sdpop_years_of_education=sdpop(years_of_education)))
```

**Step 3**
Using {ggplot}, I'm now making boxplots of each of these variables by gender.
```{r}
(height_plot <- ggplot(data = z, aes(x = gender, y = height)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Gender") +
  ylab("Height"))
```
```{r}
(weight_plot <- ggplot(data = z, aes(x = gender, y = weight)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Gender") +
  ylab("Weight"))
```
```{r}
(zombies_killed_plot <- ggplot(data = z, aes(x = gender, y = zombies_killed)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Gender") +
  ylab("Zombies Killed"))
```
```{r}
(years_of_education_plot <- ggplot(data = z, aes(x = gender, y = years_of_education)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 90)) +
  xlab("Gender") +
  ylab("Years of Education"))
```

**Step 4**
Using {ggplot}, I'm making scatterplots of height and weight in relation to age.
```{r}
(height_scatter <- ggplot(data = z, aes(x = age, y = height,
    color = factor(gender)))+ # build a plot object and color points by gender
   xlab("Age") + 
   ylab("Height")+
   geom_point(na.rm = TRUE) +
   theme(legend.position = "bottom", legend.title = element_blank()))
```

```{r}
(weight_scatter <- ggplot(data = z, aes(x = age, y = weight,
    color = factor(gender)))+ # build a plot object and color points by gender
   xlab("Age") + 
   ylab("Weight")+
   geom_point(na.rm = TRUE) +
   theme(legend.position = "bottom", legend.title = element_blank()))
```

Looking at the above scatterplots, height and weight both appear to increase with age for both females and males. 

**INCOMPLETE Step 5**
Using histograms and Q-Q plots, I'm going to check whether each of the quantitative variables seem to be drawn from a normal distribution.

First, height...
```{r}
height2 <- dnorm(z$height, mean(z$height), sdpop(z$height))

(ggplot(data=z) +
  geom_histogram(mapping=aes(x=height, y=..density..)) +
  xlab("Height") +
  ylab("Density") +
  geom_line(mapping=aes(x=height, y=height2)))
```

```{r}
q <- ppoints(length(z$height))
theoretical_q <- qnorm(q)
observed_q <- quantile(z$height,ppoints(z$height))
(plot(theoretical_q, observed_q, main = "QQ Plot - Height", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles"))
```

Height in this data set seems to be drawn from a normal distribution.


Weight...
```{r}
weight2 <- dnorm(z$weight, mean(z$weight), sdpop(z$weight))

(ggplot(data=z) +
  geom_histogram(mapping=aes(x=weight, y=..density..)) +
  xlab("Weight") +
  ylab("Density") +
  geom_line(mapping=aes(x=weight, y=weight2)))

```

```{r}
q <- ppoints(length(z$weight))
theoretical_q <- qnorm(q)
observed_q <- quantile(z$weight,ppoints(z$weight))
(plot(theoretical_q, observed_q, main = "QQ Plot - Weight", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles"))
```

Weight in this dataset seems to be drawn from a normal distribution.


Zombies killed...
```{r}
zombies_killed2 <- dnorm(z$zombies_killed, mean(z$zombies_killed), sdpop(z$zombies_killed))

(ggplot(data=z) +
  geom_histogram(mapping=aes(x=zombies_killed, y=..density..)) +
  xlab("Zombies Killed") +
  ylab("Density") +
  geom_line(mapping=aes(x=zombies_killed, y=zombies_killed2)))
```
```{r}
q <- ppoints(length(z$zombies_killed))
theoretical_q <- qnorm(q)
observed_q <- quantile(z$zombies_killed,ppoints(z$zombies_killed))
(plot(theoretical_q, observed_q, main = "QQ Plot - Zombies Killed", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles"))
```

The number of zombies killed does not appear to be drawn from a normal distribution.

Years of education...
```{r}
years_of_education2 <- dnorm(z$years_of_education, mean(z$years_of_education), sdpop(z$years_of_education))

(ggplot(data=z) +
  geom_histogram(mapping=aes(x=years_of_education, y=..density..)) +
  xlab("Years of Education") +
  ylab("Density") +
  geom_line(mapping=aes(x=years_of_education, y=years_of_education2)))
```
```{r}
q <- ppoints(length(z$years_of_education))
theoretical_q <- qnorm(q)
observed_q <- quantile(z$years_of_education,ppoints(z$years_of_education))
(plot(theoretical_q, observed_q, main = "QQ Plot - Years of Education", xlab = "Theoretical Quantiles", ylab = "Sample Quantiles"))
```

The years of education does not appear to be drawn from a normal distribution.

**INCOMPLETE Step 6**
Sample ONE subset of 50 zombie apocalypse survivors (without replacement) from this population and calculate the mean and sample standard deviation for each variable.
```{r}
zs <- slice_sample(z,n=50,replace=FALSE) #Drawing a single sample of 50 zombie apocalypse survivors without replacement

(zsampleresults <- zs |>
  summarise(sample_mean_height=mean(zs$height),sd_height=sd(zs$height),sample_mean_weight=mean(zs$height),sd_weight=sd(zs$weight),sample_mean_zombies_killed=mean(zs$zombies_killed),sd_zombies_killed=sd(zs$zombies_killed),sample_mean_years_of_education=mean(zs$years_of_education),sd_years_of_education=sd(zs$years_of_education))) 
```

Now, I will estimate the standard error for each variable based on this one sample and use that to construct a theoretical 95% confidence interval for each mean.


**INCOMPLETE Step 7**

**INCOMPLETE Step 8**

**INCOMPLETE Step 9**

**INCOMPLETE Step 10**
